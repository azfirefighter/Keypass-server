<?php
class App_model extends CI_Model {
    public function __construct()
    {
        parent::__construct();
    }
	
	public function get_apps($os)
	{
		if ($os == 'all')
		{
			$this->db->select('app_id, app_title, app_editor, app_os_id, app_store_id')->from('admin_app')->order_by('app_title', 'asc');
		} else {
			$this->db->select('app_id, app_title, app_editor, app_os_id, app_store_id')->from('admin_app')->where('app_os_id',$os)->order_by('app_title', 'asc');
		}
		// ne rapporte que peu d'infos, pour avoir tous les détails utiliser get_app()
		
		$query = $this->db->get();
		
		return $query->result_array();
	}

	/*
	 * CRUD avec un item
	 */
	public function get_app($id)
	{
		$this->db->select()->from('admin_app')->where('app_id', $id);
		$query = $this->db->get();
		
		return $query->row_array();
	}
	public function add_app($data)
	{
		$this->db->insert('admin_app', $data);
	}
	public function modify_app($id, $data)
	{
		$this->db->where('app_id', $id);
		$this->db->update('admin_app', $data);
	}
	public function delete_app($id)
	{
		$this->db->delete('admin_app', array('app_id' => $id)); 
	}
	
	// vérifie si une appli existe déjà, via le store_id ET l'os_id
	public function exist_app($os_id, $store_id)
	{
		$this->db->select()->from('admin_app')->where('app_store_id', $store_id)->where('app_os_id', $os_id);
		
		if ($this->db->count_all_results() == 1)
		{
			return TRUE;
		} else {
			return FALSE;
		}
	}
	// même chose, mais avec un app_id à nous
	public function exist_app_id($app_id)
	{
		$this->db->select()->from('admin_app')->where('app_id', $app_id);
		
		if ($this->db->count_all_results() == 1)
		{
			return TRUE;
		} else {
			return FALSE;
		}
	}

}
/* EOF */