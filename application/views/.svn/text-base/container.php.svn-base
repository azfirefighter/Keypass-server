<?php
	/*
	 * Wrapper, chargeant une page, permettant de ne pas trop se répéter
	 * @param :
	 *  - $data['page'] = nom de la vue à charger (avec le folder) + données qui lui seront repassées
	 */
	
	/*
	 * Code Php exécuté sur toutes les pages
	 */
	// set l'header Html (à faire avant tout output)
	header('Content-type: text/html; charset=UTF-8');
	// on check si la personne est bien logguée
    if ($this->user_model->is_logged() !== TRUE)
    {
         redirect('login');
    }
	// et si elle a bien les privilèges
   if ($this->user_model->has_right() == FALSE)
    {
         die('Sorry, you are not allowed to view this page.');
    }
	/*if (extension_loaded('curl') === FALSE)
	{
		die("Vous devez activer l'extension Php CURL");
	}*/
	// petite entorse à la MVC pour être sur que ce soit bien configuré partout
	$this->form_validation->set_error_delimiters('<div class="alert">', '</div>');
	
	// on est en dev, on va afficher le profiler
	$this->output->enable_profiler(TRUE);

	/*
	 * Code créant et chargeant les vues
	 */
	$this->load->view('header'); // comprend des tests, les metas, toussa toussa
	$this->load->view($page);
	$this->load->view('footer');
?>